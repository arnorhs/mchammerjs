window.MCHammer=(function(){var c="undefined",b="object";var e=function(g){return typeof g==="function"};var a=function(g){return typeof g===b&&typeof g.length==="number"};var f=function(){var m=arguments[0]||{},k=1,l=arguments.length,g=false,j;if(typeof m==="boolean"){g=m;m=arguments[1]||{};k=2}if(typeof m!==b&&!e(m)){m={}}for(;k<l;k++){if((j=arguments[k])!=null){for(var h in j){var n=m[h],o=j[h];if(m===o){continue}if(g&&o&&typeof o===b&&!o.nodeType){m[h]=f(g,n||(o.length!=null?[]:{}),o)}else{if(o!==undefined){m[h]=o}}}}}return m};function d(g){this.options=f({},{debug:false,debugOnlyTriggers:false},g);this.items={};this.events={}}d.prototype={log:function(){if(!this.options.debug){return}var g=arguments;if(this.options.debugOnlyTriggers&&g[0].indexOf("trigger:")!=0){return}Array.prototype.unshift.call(g,"{MCH.log} ");console.log.apply(console,g)},addItem:function(h,g){if(typeof this.items[h]!==c){this.log("addItem: ",h,g,"Warning: item with the same ID already there");return false}g.id=h;g._={};this.items[h]=g;this.log("addItem: ",h,g);this.trigger(g,"MCH:addItem");return true},updateItem:function(h,g){if(typeof this.items[h]===c){this.log("updateItem: ",h,"Warning: No item found with that ID");return false}this.items[h]=f(this.items[h],g);this.trigger(h,"MCH:updateItem",g);this.log("updateItem: ",h,g);return true},removeItem:function(g){if(typeof this.items[g]===c){this.log("removeItem: ",g,"Warning: No item found with that ID");return false}this.trigger(g,"MCH:removeItem");delete this.items[g];this.log("removeItem: ",g);return true},findByProperty:function(l){if(typeof l!==b){this.log("findByProperty: ",id,"Warning: No properties specified");return{}}var m={},k;for(var h in this.items){k=true;for(var g in l){if(typeof this.items[h][g]===c){k=false;break}if(l[g]!==this.items[h][g]){k=false;break}}if(k){m[this.items[h].id]=this.items[h]}}return m},findByFunction:function(j){if(!e(j)){this.log("findByFunction: ",j,"Warning: callback is not a function");return{}}var h={};for(var g in this.items){if(j.call(this,this.items[g])){h[this.items[g].id]=this.items[g]}}return h},getFirstItem:function(){this.log("getFirstItem: ");for(var g in this.items){if(!this.items.hasOwnProperty(g)){continue}return this.items[g]}},getItem:function(k){if(typeof k===c){this.log("getItem: ",k,"Warning: id provided is undefined");return{}}if(a(k)){var h=[],j=0,g=k.length;for(;j<g;j++){h.push(this.getItem(k[j]))}return h}if(typeof this.items[k]===c){this.log("getItem: ",k,"id provided not found");return{}}this.log("getItem: ",k);return this.items[k]},bind:function(g,h){if(typeof this.events[g]===c){this.events[g]=[]}if(!e(h)){this.log("bind: "+g,h,"Error: Not a function, is a: "+typeof h);return false}this.events[g].push(h);this.log("bind: "+g,h);return true},trigger:function(o,h,n){if(typeof this.events[h]===c){this.log("trigger: ",o,h,"Warning: Event triggered has no event handler");return false}var k;if(typeof o===b&&o.hasOwnProperty("_")){k=o;o=k.id}else{k=this.getItem(o)}k._.trigger=h;var m=[k];if(typeof n!==c){m.push(n)}for(var j=0,g=this.events[h].length;j<g;j++){this.events[h][j].apply(this,m)}this.log("trigger: ",o,h);return true}};return d})();